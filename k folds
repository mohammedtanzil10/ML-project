import numpy as np
from statistics import mean, stdev
from sklearn.model_selection import StratifiedKFold
from sklearn.linear_model import LogisticRegression
from sklearn.preprocessing import MinMaxScaler
from sklearn.datasets import load_breast_cancer

# 1. Load the Breast Cancer dataset
cancer = load_breast_cancer()
X = cancer.data
y = cancer.target

# 2. Preprocess data (feature scaling)
scaler = MinMaxScaler()
X_scaled = scaler.fit_transform(X)

# 3. Define the model and StratifiedKFold cross-validator
lr = LogisticRegression()
skf = StratifiedKFold(n_splits=5, shuffle=True, random_state=1)
accuracy_scores = []

# 4. Perform K-Fold Cross-Validation
for train_index, test_index in skf.split(X_scaled, y):
    X_train_fold, X_test_fold = X_scaled[train_index], X_scaled[test_index]
    y_train_fold, y_test_fold = y[train_index], y[test_index]
    lr.fit(X_train_fold, y_train_fold)
    accuracy_scores.append(lr.score(X_test_fold, y_test_fold))

# 5. Print the results
print(f'List of accuracy scores for each fold: {accuracy_scores}')
print(f'Mean Accuracy: {mean(accuracy_scores):.4f}')
print(f'Standard Deviation: {stdev(accuracy_scores):.4f}')
